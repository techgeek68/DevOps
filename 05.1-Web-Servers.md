# Web Servers:

---

This comprehensive guide explains how to install and configure both Apache and Nginx web servers to host static, PHP, and Python based websites. It also details how to secure these servers using HTTPS, implement advanced security practices, and apply enterprise level optimizations to ensure better performance, scalability, and reliability.

---

**Web Servers:**

 - A software application or a combination of hardware and software that stores, processes, and delivers web pages to users via HTTP/HTTPS.
   - Hardware:
     - Physical machine storing server software and website files, connected to the internet.
   - Software:
     - Applications like Apache, Nginx, and IIS that process requests and manage content delivery.
- Functions/Features:
  - Storing Content, Request handling, load balancing, SSL termination, Caching, Handling Protocols
- Types:
  - Static:
    - Serve pre existing files (HTML, CSS, JS, images)
  - Dynamic:
    - Process requests via applications (Python, PHP, Node.js)
    
---

**Popular Web Servers**

**Nginx**
- Architecture:
  - Event driven:
    - Nginx responds to network events (like data arrival or connection requests) via an event loop that monitors multiple connections simultaneously, rather than polling or waiting in a blocking manner.
  - Asynchronous:
    - I/O operations (disk reads, network requests) are initiated, and the worker process continues executing other tasks, getting notified when the operation completes instead of waiting idly.
  - Non blocking I/O:
    - Read/write operations return immediately, even if no data is available, allowing the worker to handle other connections instead of being stuck waiting for a single slow operation.
  - Master worker process model (single threaded event loop per worker):
    - A master process manages configuration and spawns worker processes (typically one per CPU core), where every single threaded worker runs its own event loop to handle thousands of connections efficiently without context switching overhead.
      
- Use:
  - Reverse proxy, load balancer, static content server
  - High concurrency, keep alive intensive workloads
    
- Configuration:
  - Debian/Ubuntu: `/etc/nginx/nginx.conf`, server blocks in `/etc/nginx/sites-available/` (linked to `/etc/nginx/sites-enabled/`)
  - RHEL/CentOS: `/etc/nginx/nginx.conf`, server blocks in `/etc/nginx/conf.d/`
    
- Pros:
  - High performance, low memory footprint
  - Handles thousands of concurrent connections efficiently
  - Market Share (2026) ~(33–43)% (Leading web server globally) 


**Apache HTTP Server**
- Architecture:
  - Process/Thread based with MPM
    - Apache uses interchangeable Multi Processing Modules (MPMs) that determine how the server handles concurrent connections. Only one MPM can be active at a time, chosen based on application needs and module thread safety requirements.
    - mpm_prefork (Process based, Non threaded):
      - Each client connection is handled by a dedicated child process without threads, providing maximum stability and compatibility with non thread safe modules (like mod_php), but consuming more memory and scaling poorly under high loads
    - mpm_worker (Hybrid Multi process, Multi threaded):
      - Apache spawns multiple child processes, each containing many threads, where each thread handles its own connection, offering better scalability and memory efficiency than prefork but requiring all modules to be thread safe.
    - mpm_event (Enhanced Worker, Optimized for Keep alive):
      - Built on mpm_worker with event driven enhancements, dedicated listener threads asynchronously manage keep alive and idle connections, freeing worker threads for active requests, making it the default on modern systems for optimal high concurrency performance
    
- Configuration :
  - Debian/Ubuntu: `/etc/apache2/apache2.conf`, `.htaccess`, MPM configs in `/etc/apache2/mods-available/mpm_*.conf`
  - RHEL/CentOS: `/etc/httpd/conf/httpd.conf`, `.htaccess`, MPM configs in `/etc/httpd/conf.modules.d/00-mpm.conf`
    
- Pros :
 - Modular (extensive module ecosystem), extensive feature set
 - Strong compatibility, long standing community support
 - Market Share (2026) ~10–36%

**- Other Notable Web Servers:**
  - Caddy
    - Features:
      - Automatic HTTPS (Let's Encrypt), simple configuration, written in Go
    - Uses:
      - Modern web apps, microservices, developers seeking simplicity
    - Market Share (2026) ~0.3–0.6%
     
  - LiteSpeed
    - Features:
      - Drop in Apache replacement, faster for static and dynamic PHP content, built in caching
    - Uses:
      - WordPress hosting, performance critical PHP applications
    - Market Share (2026) ~5–16%
     
  - Apache Tomcat
    - Features:
      - Java Servlet and JSP container
    - Uses:
      - Java EE web applications, enterprise environments
    - Market Share (2026) ~1%
     
  - Microsoft IIS (Internet Information Services)
    - Features:
      - Windows Server integration, .NET and ASP.NET support
    - Uses:
      - Windows enterprise environments, intranet applications
    - Market Share (2026) ~3–8%
     
**Other Examples:**
   - Jigsaw (W3C's experimental web server)
   - Oracle iPlanet Web Server
   - Lighttpd (lightweight, event driven)
   - Kestrel (cross platform web server for ASP.NET Core)
    
---

**SSH Login for Remote Server Access**
- Linux/Unix:
  - Syntax:
  ```bash
    ssh devops@<Server_IP> or <Server_hostname>
  ```

- Windows: 
  - For Windows 8 and earlier:
   - Download & install [MobaXterm](https://mobaxterm.mobatek.net/)  
     - Start local terminal
    
  - SSH works natively on Windows 10 (build 1809 and later) and Windows 11
    - Open a terminal (Command Prompt, PowerShell, or Windows Terminal).
    - Check if SSH is installed by typing ssh; a usage message means it’s ready.
    
> If not installed, go to Settings > Apps > Optional features > Add a feature and install OpenSSH Client.

 - Example:
   - Default port
  ```bash
  ssh devops@192.168.100.172
 ```
   - Custom port
 ```bash
  ssh -p 2222 devops@server-ip 
  ```

**SSH Configuration File (~/.ssh/config)**

- Example:
  
```bash
Host webserver
    HostName 192.168.100.172
    User devops
    Port 22
    IdentityFile ~/.ssh/webserver_key

Host appserver
    HostName 192.168.100.173  
    User devops
    ProxyJump webserver
```


---

**SELinux and Security**

- Check SELinux status:
  ```bash
  getenforce
  ```
  
- View logs:
  ```bash
  sudo cat /var/log/audit/audit.log | grep nginx
  ```
  ```bash
  sudo cat /var/log/audit/audit.log | grep httpd
  ```
  
- List and set booleans:
  ```bash
  getsebool -a
  ```
  ```bash
  getsebool -a | grep network
  ```
  <img width="846" height="103" alt="Screenshot 2026-01-25 at 6 59 46 AM" src="https://github.com/user-attachments/assets/2242af27-5143-4f3d-979f-9306f9a04506" />

  ```bash
  setsebool -P httpd_can_network_connect=1
  ```
  ```bash
  getsebool -a | grep httpd_can_network_connect
  ```
<img width="840" height="129" alt="Screenshot 2026-01-25 at 7 00 44 AM" src="https://github.com/user-attachments/assets/a6e52267-9511-4a6a-9d86-1a8ba23961b6" />

---

# Apache HTTP Server (Apache)

Introduction:
 * Free, open source, cross platform(Runs on Linux, Windows, macOS, Unix, and other operating systems) web server
 * Developed and maintained by the Apache Software Foundation (ASF)
 * Core component of the LAMP stack (Linux, Apache, MySQL, PHP/Python/Perl)

Features
 * Modular Architecture
   * Highly extensible via loadable modules (enable/disable features as needed), modules include:
     * mod_ssl (SSL/TLS support for HTTPS)
     * mod_rewrite (URL rewriting and redirects)
     * mod_security (web application firewall)
     * mod_proxy (reverse proxy and load balancing)
     * mod_auth_* (authentication modules)
     * Support for dynamic languages via mod_php, mod_python, mod_perl, etc.
      
 * Flexible Configuration
   * `.htaccess support`: Directory level configuration without modifying the main server config
     * Enables per directory security, redirects, authentication, and custom error pages
     * Useful for shared hosting environments where users lack root access
       
> Note: For better security, disable directory indexing with `Options -Indexes` to prevent file browsing
     
 * Virtual Hosting
   * Supports name based and IP based virtual hosts
   * Enables hosting multiple websites on a single server

 * Strong Security
   * Regular security updates and patches
   * Built in modules for SSL/TLS, authentication, and access control
   * Custom error documents to hide server details
   * IP based restrictions, password protection (`.htpasswd`), and user agent filtering
   * Hide server signature: `ServerSignature Off` and `ServerTokens Prod`
   * Use `mod_security` for web application firewall (WAF) protection
   * Keep Apache and modules updated

 * Basic Operation
   * Listens on HTTP/HTTPS ports (default: 80 for HTTP, 443 for HTTPS)
   * Receives client requests for web pages or resources
   * Processes requests based on configuration (serves static files, executes scripts, proxies to backend)
   * Returns responses to clients (HTML, CSS, images, JSON, etc.)

 * Uses:
   * Static Website Hosting
     * Serves HTML, CSS, JavaScript, images, and other static files efficiently
       
   * Dynamic Website Hosting
     * Executes server side scripts using:
       * PHP (via mod_php or PHP-FPM)
       * Python (via mod_wsgi or CGI)
       * Perl (via mod_perl or CGI)
         
   * Reverse Proxy & Load Balancing
     * Acts as a reverse proxy to forward requests to backend application servers (Node.js, Tomcat, etc.)
     * Distributes traffic across multiple servers for load balancing
     * Modules: mod_proxy, mod_proxy_http, mod_proxy_balancer

  * API Gateway
    * Serves RESTful APIs and microservices
    * Can handle authentication, rate limiting, and SSL termination
      
  * Development & Testing
    * Bundled in local development stacks (XAMPP, MAMP, WAMP) for rapid prototyping

 
**A. Install & Start Apache (CentOS/RHEL/Fedora)**

- Check if the Apache HTTP Server package is installed
```bash
rpm -q httpd              
```

- Update all installed packages to the latest version automatically (Optional)
```bash
sudo yum update -y
```

- Install Apache HTTP Server without prompting for confirmation
```bash
sudo yum install httpd -y
```

 - Start the Apache HTTP Server service immediately & enable Apache to start automatically at boot
```bash
sudo systemctl start httpd   
sudo systemctl enable httpd    
```

 - Check the status of the Apache service
```bash
sudo systemctl status httpd
```
<img width="764" height="440" alt="Screenshot 2026-01-25 at 7 02 12 AM" src="https://github.com/user-attachments/assets/6fb3b319-2d53-4681-8284-abfa4d5b90a0" />

 - Display Apache version
```bash
httpd -v                    
```
<img width="663" height="87" alt="Screenshot 2025-11-05 at 12 06 30 PM" src="https://github.com/user-attachments/assets/718733de-b209-4ab6-98ae-4aa51583eba8" />


**B. Open Firewall Ports**

 - Open HTTP port (80) & HTTPS port (443) permanently
```bash
sudo firewall-cmd --permanent --add-service={http,https}
```
 - Apply the new firewall rules
```bash
sudo firewall-cmd --reload                                
```
 - Verify active services and open ports
```bash
sudo firewall-cmd --list-all                              
```

<img width="665" height="471" alt="Screenshot 2025-11-05 at 12 13 53 PM" src="https://github.com/user-attachments/assets/40e7d132-f844-4ece-b38d-f8190a72a673" />

<img width="659" height="363" alt="Screenshot 2025-11-05 at 12 19 20 PM" src="https://github.com/user-attachments/assets/7a8673aa-d79c-4a01-aa69-5b4c08a16eba" />


**C. Verify Installation**
  - Visit:
    - http://server-ip
          or
    - http://localhost
          or
    - http://127.0.0.1

<img width="805" height="575" alt="Screenshot 2025-11-05 at 12 22 18 PM" src="https://github.com/user-attachments/assets/1ee0d323-42d5-4e2e-bbea-c6a4d62cff7e" />

      
  - Check hosts: cat /etc/hosts
  
  <img width="716" height="165" alt="Screenshot 2025-11-05 at 12 20 24 PM" src="https://github.com/user-attachments/assets/71fb04f2-84e4-4261-9670-6d6a5b9a8655" />

---

# Hosting a Static Website

**A. Directory Setup**
 - Create a web directory
```bash
sudo mkdir -p /var/www/html
```
```bash
sudo mkdir -p /var/www/html/{page1,page2}
```
 - Set permissions
```bash
sudo chown -R apache:apache /var/www/html
```
```bash
sudo chmod -R 755 /var/www/html
```
 - Verify ownership
```bash
ls -ld /var/www/html/
```
<img width="773" height="186" alt="Screenshot 2026-01-25 at 7 13 26 AM" src="https://github.com/user-attachments/assets/9250d814-07bf-4abb-952e-c531cc7916b9" />


**B. Create Pages**

```bash
sudo vim /var/www/html/index.html
```

```bash
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Hari Bahadur - Full Stack Developer</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        
        header {
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        
        h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .subtitle {
            margin-top: 8px;
            font-size: 1.2em;
            color: #666;
        }
        
        nav {
            margin-top: 15px;
        }
        
        nav a {
            color: #0066cc;
            text-decoration: none;
            padding: 8px 16px;
            margin-right: 10px;
            border-radius: 4px;
            transition: background-color 0.3s ease;
        }
        
        nav a:hover {
            background-color: #f0f0f0;
        }
        
        nav a:not(:last-child) {
            border-right: 1px solid #ccc;
            border-radius: 0;
        }
    </style>
</head>
<body>
    <header>
        <h1> Hari Bahadur</h1>
        <p class="subtitle">Full Stack Developer</p>
        <nav>
            <a href="/page1">Page 1</a>
            <a href="/page2">Page 2</a>
        </nav>
    </header>
</body>
</html>
```

**Subdirectory pages**

`sudo vim /var/www/html/page1/index.html`

```bash
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Page 1 | My Website</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        
        header {
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        
        h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 600;
            color: #2c3e50;
        }
        
        nav {
            margin-top: 15px;
        }
        
        nav a {
            color: #0066cc;
            text-decoration: none;
            padding: 8px 16px;
            margin-right: 10px;
            border-radius: 4px;
            transition: background-color 0.3s ease;
        }
        
        nav a:hover {
            background-color: #f0f0f0;
        }
        
        nav a:not(:last-child) {
            border-right: 1px solid #ccc;
            border-radius: 0;
        }
        
        main {
            padding: 20px 0;
        }
        
        .content {
            background-color: #f9f9f9;
            padding: 30px;
            border-radius: 8px;
            border-left: 4px solid #0066cc;
        }
    </style>
</head>
<body>
    <header>
        <h1>Page 1</h1>
        <nav>
            <a href="/">Home</a>
            <a href="/page1">Page 1</a>
            <a href="/page2">Page 2</a>
        </nav>
    </header>
    
    <main>
        <div class="content">
            <h2>Welcome to Page 1</h2>
            <p>This is the first page of the website.</p>
        </div>
    </main>
</body>
</html>
```

`sudo vim /var/www/html/page2/index.html`

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Page 2 | My Website</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        
        header {
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        
        h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 600;
            color: #2c3e50;
        }
        
        nav {
            margin-top: 15px;
        }
        
        nav a {
            color: #0066cc;
            text-decoration: none;
            padding: 8px 16px;
            margin-right: 10px;
            border-radius: 4px;
            transition: background-color 0.3s ease;
        }
        
        nav a:hover {
            background-color: #f0f0f0;
        }
        
        nav a:not(:last-child) {
            border-right: 1px solid #ccc;
            border-radius: 0;
        }
        
        main {
            padding: 20px 0;
        }
        
        .content {
            background-color: #f9f9f9;
            padding: 30px;
            border-radius: 8px;
            border-left: 4px solid #0066cc;
        }
    </style>
</head>
<body>
    <header>
        <h1>Page 2</h1>
        <nav>
            <a href="/">Home</a>
            <a href="/page1">Page 1</a>
            <a href="/page2">Page 2</a>
        </nav>
    </header>
    
    <main>
        <div class="content">
            <h2>Welcome to Page 2</h2>
            <p>This is the second page of the website.</p>
        </div>
    </main>
</body>
</html>
```

Check Syntax Error:
```
httpd -t
```

```bash
sudo systemctl restart httpd
```

**C.Test**

 - Visit: `http://localhost/`, `http://localhost/page1`, `http://localhost/page2`

<img width="1441" height="407" alt="Screenshot 2026-01-25 at 7 29 25 AM" src="https://github.com/user-attachments/assets/8417c7f0-0d1c-46df-a87c-e813eab9f7ba" />


<img width="1442" height="507" alt="Screenshot 2026-01-25 at 7 29 37 AM" src="https://github.com/user-attachments/assets/da7ea686-7807-47d8-bcd0-9e2eb11c8aa1" />


<img width="1443" height="481" alt="Screenshot 2026-01-25 at 7 29 45 AM" src="https://github.com/user-attachments/assets/1c48404f-9596-495f-ad54-a4f124881191" />

---

# 4. Apache Main Configuration

- Main config file: `/etc/httpd/conf/httpd.conf`
- Key directives to check

```bash
cat /etc/httpd/conf/httpd.conf
```
```bash
DocumentRoot "/var/www/html"   # Directory where website files are served from
ServerRoot "/etc/httpd"        # Location of the Apache server’s configuration files
Listen 80                      # Apache listens for incoming connections on port 80
```
  
<img width="662" height="469" alt="Screenshot 2025-11-06 at 6 58 43 AM" src="https://github.com/user-attachments/assets/8bb4e908-cf91-4f46-b60c-2c6da80ff26f" />

---

# 5. Virtual Host:

 - A Virtual Host is a method for hosting multiple websites (with separate domain names) on a single Apache server. Instead of requiring multiple physical machines, Apache uses the requested domain name or IP address to determine which website's content to serve.
   
  - **IP based Virtual Hosts**
    - Different websites use different IP addresses on the same server.
 
  - **Name based Virtual Hosts**
    - Different websites share the same IP address, and Apache distinguishes them by the domain name in the Host: HTTP header. This is the most common method.

  
**Virtual Host Configuration**:
  - Syntax 
```bash
<VirtualHost [IP_Address]:[Port]>                                # Defines a virtual host for a specific IP and port
    ServerName www.example.com                                   # Primary domain handled by this virtual host
    ServerAlias example.com *.example.org                        # Alternate domains served by the same configuration
    ServerAdmin webmaster@example.com                            # Contact email for the server administrator
    DocumentRoot /var/www/example.com/html                       # Directory containing the website’s files

    <Directory /var/www/example.com/html>                        # Applies settings to the DocumentRoot directory
        AllowOverride All                                        # Enables use of .htaccess files
        Require all granted                                      # Allows all clients to access the site
    </Directory>

    ErrorLog ${APACHE_LOG_DIR}/example.com_error.log              # File to store error messages for this site
    CustomLog ${APACHE_LOG_DIR}/example.com_access.log combined   # File and format for access logs
</VirtualHost>                                                    # End of virtual host definition
``` 

**Example 1:**
   - Let's create a virtual host for myapp.com.np
   
   - Create the Directory Structure
```bash
sudo mkdir -p /var/www/myapp.com.np
```

   - Assign Ownership and Permissions
```bash
sudo chown -R $USER:$USER /var/www/myapp.com.np
```
```bash
sudo chmod -R 755 /var/www/myapp.com.np
```
```bash
ls -ld /var/www/myapp.com.np
```

- Edit DocumentRoot file: `sudo vim /etc/httpd/conf/httpd.conf`
     
<img width="787" height="474" alt="Screenshot 2025-11-06 at 12 21 16 PM" src="https://github.com/user-attachments/assets/7a3fb938-e204-4354-9237-79aa4232daf9" />


 - Create a Sample index.html File
```bash
sudo vim /var/www/myapp.com.np/index.html
```
 - Add content
 ```html
<html>
  <head>
    <title>Welcome to MyApp!</title>
  </head>
  <body>
    <h1>Success! The myapp.com.np virtual host is working!</h1>
    
    <details>
      <summary>Click to learn more</summary>
      <p>Your virtual host is configured correctly and ready to use!</p>
    </details>
    
    <hr>
    
    <h2>Quick Survey</h2>
    <form>
      <label>What brings you here?</label><br>
      <input type="radio" id="testing" name="reason" value="testing">
      <label for="testing">Testing my setup</label><br>
      <input type="radio" id="exploring" name="reason" value="exploring">
      <label for="exploring">Just exploring</label><br>
      <input type="radio" id="deploying" name="reason" value="deploying">
      <label for="deploying">Deploying an app</label><br><br>
      
      <label for="feedback">Any feedback?</label><br>
      <textarea id="feedback" rows="3" cols="40"></textarea><br><br>
      
      <button type="submit">Submit</button>
    </form>
    
    <hr>
    
    <details>
      <summary> Resources</summary>
      <ul>
        <li><a href="#docs">Documentation</a></li>
        <li><a href="#support">Support</a></li>
        <li><a href="#faq">FAQ</a></li>
      </ul>
    </details>
    
  </body>
</html>
```

  - Create the Virtual Host File 
 ```bash
 sudo nano /etc/apache2/sites-available/myapp.com.np.conf       #Debian/Ubuntu
```

```bash 
 sudo vim /etc/httpd/conf.d/myapp.com.np.conf                   #RedHat/CentOS/Fedora
 ```
   
  - Add the following configuration:
 ```apache
<VirtualHost *:80>                                              # Virtual host listening on port 80 (HTTP)
    ServerName myapp.com.np                                     # Primary domain name for this website
    ServerAlias www.myapp.com.np                                # Additional domain name pointing to the same site
    DocumentRoot /var/www/myapp.com.np                          # Directory where the website files are stored
    ErrorLog /var/log/httpd/myapp.com.np_error.log              # File where Apache logs errors for this site
    CustomLog /var/log/httpd/myapp.com.np_access.log combined   # File and format for access logs

    # Directory settings
    <Directory "/var/www/html/myapp.com.np">                    # Configuration for this site’s root directory
        Options Indexes FollowSymLinks                          # Enables directory listing and symbolic links
        AllowOverride All                                       # Allows use of .htaccess files for overrides
        Require all granted                                     # Grants access to all clients
    </Directory>
</VirtualHost>                                                  # End of virtual host configuration
 ```

 - Demo Image:
<img width="528" height="471" alt="Screenshot 2025-11-06 at 12 17 40 PM" src="https://github.com/user-attachments/assets/4321cfc7-8d18-466f-96d6-2291d185939e" />

```bash
httpd -t                         #Check Syntax
```
```bash
sudo httpd -S                    #Show vhosts
```
<img width="1022" height="109" alt="Screenshot 2025-11-06 at 12 18 05 PM" src="https://github.com/user-attachments/assets/31e90c18-fe95-48e5-86d6-643c61ae5fca" />

 - Reload HTTPD Service
```
systemctl restart httpd
```

 - Test the page
<img width="1218" height="742" alt="Screenshot 2026-01-26 at 7 29 06 AM" src="https://github.com/user-attachments/assets/7366b370-f276-4ed6-8125-9cc5abf0cadb" />



**Example 2: Multiple Websites with Virtual Hosts**

- Directory Structure:
 - Create directories for multiple sites
```bash
sudo mkdir -p /var/www/example1.com
sudo mkdir -p /var/www/example2.com
```
 - Set permissions
```bash
sudo chown -R apache:apache /var/www/example1.com
sudo chown -R apache:apache /var/www/example2.com
sudo chmod -R 755 /var/www
```

- Create sample web pages:
  
   `sudo vim /var/www/example1.com/index.html`
  
```html
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>example1.com — It works!</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root { color-scheme: light dark; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; margin: 2rem; }
    .card {
      max-width: 720px; margin: 0 auto; padding: 2rem;
      border-radius: 12px; border: 1px solid #d0d7de;
    }
    h1 { margin: 0 0 .5rem; }
    code { background: rgba(127,127,127,.15); padding: .2rem .4rem; border-radius: 6px; }
  </style>
</head>
<body>
  <div class="card">
    <h1>It works! example1.com</h1>
    <p>You are seeing the site served from <code>/var/www/example1.com</code>.</p>
    <p>ServerName: <strong>example1.com</strong></p>
    <p>If this is not the site you expected, check your VirtualHost <code>DocumentRoot</code> and <code>ServerName</code> settings.</p>
  </div>
</body>
</html>
```

   `sudo vim /var/www/example2.com/index.html`
   
```html
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>example2.com — It works!</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root { color-scheme: light dark; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; margin: 2rem; }
    .card {
      max-width: 720px; margin: 0 auto; padding: 2rem;
      border-radius: 12px; border: 1px solid #d0d7de;
    }
    h1 { margin: 0 0 .5rem; }
    code { background: rgba(127,127,127,.15); padding: .2rem .4rem; border-radius: 6px; }
  </style>
</head>
<body>
  <div class="card">
    <h1>It works! example2.com</h1>
    <p>You are seeing the site served from <code>/var/www/example2.com</code>.</p>
    <p>ServerName: <strong>example2.com</strong></p>
    <p>If this is not the site you expected, check your VirtualHost <code>DocumentRoot</code> and <code>ServerName</code> settings.</p>
  </div>
</body>
</html>
```

- Virtual Host Configurations:
  
  `sudo vim /etc/httpd/conf.d/example1.com.conf`

```apache
<VirtualHost *:80>
    ServerAdmin admin@example1.com
    ServerName example1.com
    ServerAlias www.example1.com
    DocumentRoot /var/www/example1.com

    ErrorLog /var/log/httpd/example1_error.log
    CustomLog /var/log/httpd/example1_access.log combined

    <Directory "/var/www/example1.com">
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>
</VirtualHost>
```

 `sudo vim /etc/httpd/conf.d/example2.com.conf`
 
```apache
<VirtualHost *:80>
    ServerAdmin admin@example2.com
    ServerName example2.com
    ServerAlias www.example2.com
    DocumentRoot /var/www/example2.com

    ErrorLog /var/log/httpd/example2_error.log
    CustomLog /var/log/httpd/example2_access.log combined

    <Directory "/var/www/example2.com">
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>
</VirtualHost>
```
  
```bash
sudo apachectl configtest
```
```bash
sudo systemctl restart httpd
```

 - Local Testing Setup:
   
   - Edit `/etc/hosts` on your local machine:
     - `sudo vim /etc/hosts` 
     
```text
10.10.5.9 www.example1.com
10.10.5.9 www.example2.com
```
<img width="956" height="211" alt="Screenshot 2026-01-26 at 11 51 00 AM" src="https://github.com/user-attachments/assets/9d1fb514-0bc4-451f-817d-6c6f4767ad12" />


 - On your browser
   - http://www.example1.com/
<img width="794" height="371" alt="Screenshot 2025-11-06 at 12 52 46 PM" src="https://github.com/user-attachments/assets/19eac9b3-6617-436b-a96e-726ee89ade0e" />


   - http://www.example2.com/
<img width="803" height="379" alt="Screenshot 2025-11-06 at 12 53 33 PM" src="https://github.com/user-attachments/assets/edcdfe83-4260-45f4-9bb4-cb56a85ec6ea" />


---

> Before creating  a PHP based website, delete previously created webpages `var/www/` and virtual host configuration file `/etc/httpd/conf.d`

---

# 6. Hosting PHP Websites

Apache supports two primary methods for processing PHP:

- mod_php (Traditional)
  - PHP runs as an Apache module
  - Simpler setup, but less flexible
  - All Apache child processes load PHP, consuming more memory

- PHP-FPM (FastCGI Process Manager) [Recommended]
  - PHP runs as a separate process
  - Better performance, especially for high traffic sites
  - More secure and resource-efficient
  - Supports different PHP versions for different sites


**A. Install PHP and Dependencies**

 - For RHEL/CentOS/Fedora:
```bash
sudo dnf install php php-fpm php-mysqlnd php-json php-xml php-mbstring -y   # Install PHP and common PHP modules
sudo dnf install php php-cli php-common -y                                  # Install Apache PHP module (mod_php) components
```
```bash
sudo systemctl start php-fpm                                                # Start PHP-FPM service
sudo systemctl enable php-fpm                                               # Enable PHP-FPM to start at boot
sudo systemctl status php-fpm                                               # Check PHP-FPM service status
```
```bash
php -v                                                                      # Display PHP version
```

**B. Configure Firewall**
 - Open HTTP port
```bash
sudo firewall-cmd --permanent --add-service=http
sudo firewall-cmd --reload
```

 - Alternative: Open a specific port
```bash
sudo firewall-cmd --permanent --add-port=80/tcp
sudo firewall-cmd --reload
```

**C. Virtual Host Configuration**

 `sudo vim /etc/httpd/conf.d/phpwebsite.conf`

- Method 1: Using PHP-FPM (Recommended)
```apache
<VirtualHost *:80>
    ServerAdmin admin@phpwebsite.local
    ServerName phpwebsite.local
    DocumentRoot /var/www/phpwebsite
    
    # PHP handling via PHP-FPM with ProxyFCGI
    <FilesMatch \.php$>
        SetHandler "proxy:unix:/run/php-fpm/www.sock|fcgi://localhost"
    </FilesMatch>
    
    # Alternative syntax for some distributions
    # <FilesMatch \.php$>
    #    SetHandler "proxy:fcgi://127.0.0.1:9000"
    # </FilesMatch>
    
    <Directory "/var/www/phpwebsite">
        Options -Indexes +FollowSymLinks +MultiViews
        AllowOverride All
        Require all granted
        
        # Security headers
        Header always set X-Content-Type-Options nosniff
        Header always set X-Frame-Options DENY
    </Directory>
    
    # Log configuration
    ErrorLog /var/log/httpd/phpwebsite_error.log
    CustomLog /var/log/httpd/phpwebsite_access.log combined
    LogLevel warn
</VirtualHost>
```


>- Method 2: Using mod_php (Traditional)
>```apache
><VirtualHost *:80>
>    ServerAdmin admin@phpwebsite.local
>   ServerName phpwebsite.local
>    DocumentRoot /var/www/phpwebsite
>    
>    # With mod_php, PHP processing is automatic
>    # Ensure mod_php is loaded: LoadModule php_module modules/libphp.so
>    
>    <Directory "/var/www/phpwebsite">
>        Options -Indexes +FollowSymLinks
>        AllowOverride All
>        Require all granted
>    </Directory>
>    
>    ErrorLog /var/log/httpd/phpwebsite_error.log
>    CustomLog /var/log/httpd/phpwebsite_access.log combined
></VirtualHost>
>```


**D. Directory Structure and Permissions**
```bash
sudo mkdir -p /var/www/phpwebsite
```

```bash
sudo vim /var/www/phpwebsite/index.php
```
```php
<?php
session_start();
$_SESSION['visits'] = ($_SESSION['visits'] ?? 0) + 1;
$greeting = $_POST['name'] ?? '';
?>
<!DOCTYPE html>
<html>
<head>
    <title>PHP Demo</title>
    <style>
        body { font-family: Arial; max-width: 600px; margin: 50px auto; padding: 20px; }
        .box { background: #f4f4f4; padding: 15px; margin: 10px 0; border-radius: 5px; }
        input, button { padding: 8px; margin: 5px 0; }
        button { background: #007bff; color: white; border: none; cursor: pointer; }
    </style>
</head>
<body>
    <h1>PHP Localhost Demo</h1>
    
    <div class="box">
        <h3>Server Info</h3>
        <p>Server: <?= $_SERVER['SERVER_NAME'] ?></p>
        <p>PHP Version: <?= phpversion() ?></p>
        <p>Time: <?= date('Y-m-d H:i:s') ?></p>
    </div>

    <div class="box">
        <h3>Session Counter</h3>
        <p>You've visited this page <strong><?= $_SESSION['visits'] ?></strong> times</p>
    </div>

    <div class="box">
        <h3>Form Test</h3>
        <form method="POST">
            <input type="text" name="name" placeholder="Your name" required>
            <button>Submit</button>
        </form>
        <?php if ($greeting): ?>
            <p style="color: green; margin-top: 10px;">Hello, <strong><?= htmlspecialchars($greeting) ?></strong>!</p>
        <?php endif; ?>
    </div>

    <div class="box">
        <h3>Array Loop</h3>
        <?php 
        $features = ['Sessions', 'Forms', 'Date/Time', 'Arrays'];
        foreach ($features as $f) echo "<li>$f</li>";
        ?>
    </div>
</body>
</html>
```

```bash
sudo chown -R apache:apache /var/www/phpwebsite              # Set Apache as the owner and group for the website directory
```
```bash
sudo chmod -R 755 /var/www/phpwebsite                        # Give owner full access, others read and execute permissions for directories
```
```bash
sudo find /var/www/phpwebsite -type f -exec chmod 644 {} \;  # Set file permissions to read/write for owner and read-only for others
```
  
**E. Final Configuration and Testing**
```bash
sudo httpd -t                                 # Test Apache configuration syntax for errors
```
```bash
sudo systemctl restart php-fpm                # Restart PHP-FPM service to apply changes
sudo systemctl restart httpd                  # Restart Apache service
```
```bash
sudo systemctl enable php-fpm                 # Enable PHP-FPM to start automatically at boot
sudo systemctl enable httpd                   # Enable Apache to start automatically at boot
```
```bash
sudo systemctl status php-fpm                 # Check current status of PHP-FPM service
sudo systemctl status httpd                   # Check current status of Apache service
```

Test: `http://127.0.0.1/`

![Screenshot 2026-01-26 at 12 38 08 PM](https://github.com/user-attachments/assets/382b79a8-f6c9-43db-a43a-a84387e45ffb)


---


# 7. Hosting Python Websites (`mod_wsgi`)

- `mod_wsgi` is an Apache HTTP Server module that enables hosting Python web applications using the WSGI (Web Server Gateway Interface) specification.

- WSGI is a standard interface between web servers and Python web applications/frameworks (such as Django, Flask, or Pyramid). `mod_wsgi` acts as the bridge between Apache and your Python code.

- Deployment Modes
  - Embedded Mode: Python runs within Apache processes (Simpler setup, Shares memory)
  - Daemon Mode: Python runs in separate processes (Better isolation, Resource control, Recommended for production)

- Installation and Setup
  
- Basic Setup:
```python
  # Example WSGI application file (app.wsgi)
def application(environ, start_response):
    status = '200 OK'
    output = b'Hello World!'
    
    response_headers = [('Content-type', 'text/plain'),
                        ('Content-Length', str(len(output)))]
    start_response(status, response_headers)
    
    return [output]
```
```apache
# Apache configuration
WSGIScriptAlias / /path/to/app.wsgi
WSGIDaemonProcess myapp python-path=/path/to/project
WSGIProcessGroup myapp

<Directory /path/to/project>
    Require all granted
</Directory>
```

**- Complete Example:**
 - For RHEL/CentOS/Fedora:
```bash
sudo dnf install httpd python3 python3-mod_wsgi -y
```

- Start and enable Apache
```bash
sudo systemctl enable httpd --now
```

- Verify mod_wsgi installation
```bash
sudo httpd -M | grep wsgi
```

 - Configure Firewall
  - Open HTTP and HTTPS ports
```bash
sudo firewall-cmd --permanent --add-service=http
sudo firewall-cmd --permanent --add-service=https
sudo firewall-cmd --reload
```
  - Alternative: Open specific ports
```bash
sudo firewall-cmd --permanent --add-port=80/tcp
sudo firewall-cmd --permanent --add-port=443/tcp
sudo firewall-cmd --reload
```

- Directory Structure and Application Setup
   - Create project directory
```bash
sudo mkdir -p /var/www/python
```
   - Create WSGI application file
```bash
sudo vim /var/www/python/wsgi.py
```

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import sys
import logging

# Add application directory to path
sys.path.insert(0, '/var/www/python')

# Setup basic logging
logging.basicConfig(stream=sys.stderr, level=logging.DEBUG)
logger = logging.getLogger(__name__)

def application(environ, start_response):
    """Simple WSGI application for testing."""
    
    logger.info("WSGI application called successfully")
    
    status = '200 OK'
    response_headers = [
        ('Content-Type', 'text/html; charset=utf-8'),
    ]
    start_response(status, response_headers)
    
    html = """<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python WSGI Application</title>
    <style>
        body {{
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0;
            padding: 20px;
        }}
        .container {{
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
            max-width: 700px;
            width: 100%;
        }}
        h1 {{
            color: #667eea;
            margin: 0 0 10px 0;
        }}
        .subtitle {{
            color: #666;
            margin-bottom: 30px;
        }}
        h2 {{
            color: #764ba2;
            margin: 30px 0 15px 0;
            border-bottom: 2px solid #667eea;
            padding-bottom: 8px;
        }}
        .info-item {{
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 6px;
            border-left: 4px solid #667eea;
        }}
        .info-label {{
            font-weight: 600;
            color: #764ba2;
        }}
        .info-value {{
            color: #555;
            font-family: 'Courier New', monospace;
        }}
    </style>
</head>
<body>
    <div class="container">
        <h1>WSGI Application Running!</h1>
        <p class="subtitle">Successfully deployed on Apache with mod_wsgi</p>
        
        <h2>Server Information</h2>
        <div class="info-item">
            <div class="info-label">Python Version:</div>
            <div class="info-value">{python_version}</div>
        </div>
        <div class="info-item">
            <div class="info-label">Server Software:</div>
            <div class="info-value">{server_software}</div>
        </div>
        <div class="info-item">
            <div class="info-label">Request Method:</div>
            <div class="info-value">{request_method}</div>
        </div>
        <div class="info-item">
            <div class="info-label">Request Path:</div>
            <div class="info-value">{path_info}</div>
        </div>
        <div class="info-item">
            <div class="info-label">Client IP:</div>
            <div class="info-value">{remote_addr}</div>
        </div>
    </div>
</body>
</html>""".format(
        python_version=sys.version.split()[0],
        server_software=environ.get('SERVER_SOFTWARE', 'Unknown'),
        request_method=environ.get('REQUEST_METHOD', 'GET'),
        path_info=environ.get('PATH_INFO', '/'),
        remote_addr=environ.get('REMOTE_ADDR', 'Unknown')
    )
    
    return [html.encode('utf-8')]
```

 - Set Proper Permissions
   - Set ownership to Apache user  
```bash
sudo chown -R apache:apache /var/www/python
```

> For RHEL/CentOS/Fedora, the Apache user is typically 'apache'
> For Debian/Ubuntu, the Apache user generally is 'www-data'

   - Set appropriate permissions
```bash
sudo chmod -R 755 /var/www/python
sudo chmod 644 /var/www/python/*.wsgi
sudo chmod 644 /var/www/python/*.py
```

 - Virtual Host Configuration
   `sudo vim /etc/httpd/conf.d/python.conf`
   
```apache
<VirtualHost *:80>
    # Server Identification
    ServerAdmin admin@python.local
    ServerName python.local
    ServerAlias localhost 127.0.0.1

    # Document Root
    DocumentRoot /var/www/python

    # WSGI Daemon Process Configuration
    # Improved: Added python-path, increased processes, better resource limits
    WSGIDaemonProcess python-app \
        user=apache \
        group=apache \
        processes=2 \
        threads=15 \
        python-path=/var/www/python \
        display-name=%{GROUP} \
        lang='en_US.UTF-8' \
        locale='en_US.UTF-8' \
        maximum-requests=10000 \
        umask=0007

    # WSGI Script Configuration
    # Changed to match the new filename (wsgi.py)
    WSGIScriptAlias / /var/www/python/wsgi.py

    # Script Directory Configuration
    <Directory /var/www/python>
        WSGIProcessGroup python-app
        WSGIApplicationGroup %{GLOBAL}
        
        # Security: Only allow .wsgi and .py files to be executed
        <Files "wsgi.py">
            Require all granted
        </Files>
        
        # Deny access to all other files by default
        <FilesMatch "^(?!wsgi\.py$)">
            Require all denied
        </FilesMatch>
        
        Options -Indexes -FollowSymLinks
        AllowOverride None
    </Directory>

    # Static Files Directory
    Alias /static /var/www/python/static
    <Directory /var/www/python/static>
        Require all granted
        Options -Indexes
        
        # Enable caching for static files
        <IfModule mod_expires.c>
            ExpiresActive On
            ExpiresDefault "access plus 1 year"
        </IfModule>
        
        # Enable compression for static files
        <IfModule mod_deflate.c>
            AddOutputFilterByType DEFLATE text/css text/javascript application/javascript
        </IfModule>
    </Directory>

    # Logging Configuration
    # Added directory for WSGI application logs
    ErrorLog /var/log/httpd/python_error.log
    CustomLog /var/log/httpd/python_access.log combined
    
    # Increased log level for better debugging during setup
    # Change to 'warn' in production
    LogLevel info
    
    # WSGI-specific logging
    # This will help debug WSGI application issues
    LogLevel wsgi:info

    # Security Headers (requires mod_headers)
    <IfModule mod_headers.c>
        # Prevent clickjacking
        Header always set X-Frame-Options "SAMEORIGIN"
        
        # Prevent MIME type sniffing
        Header always set X-Content-Type-Options "nosniff"
        
        # Enable XSS protection
        Header always set X-XSS-Protection "1; mode=block"
        
        # Remove server signature
        Header unset Server
    </IfModule>

    # Performance: Enable KeepAlive for this virtual host
    KeepAlive On
    MaxKeepAliveRequests 100
    KeepAliveTimeout 5
</VirtualHost>
```

 - Final Steps and Testing
   - Test Apache configuration 
```bash
sudo apachectl configtest
```
   - If using SELinux (RHEL/CentOS/Fedora) 
```bash
sudo setsebool -P httpd_execmem 1
sudo chcon -R -t httpd_sys_content_t /var/www/python
```
  - Restart Apache
```bash
sudo systemctl restart httpd
```

  - Check status
```bash
sudo systemctl status httpd
```

Test the application: `http://127.0.0.1/` or `http://localhost/`

<img width="1217" height="794" alt="Screenshot 2026-01-28 at 8 19 30 AM" src="https://github.com/user-attachments/assets/935d1e9b-9f4c-438e-9be6-0b729e9abdb6" />


---


# 8. Hosting a Secure Site (HTTPS/SSL with Apache)

* HTTPS encrypts communication between web browsers and servers using SSL/TLS certificates, protecting data from interception and ensuring authenticity.
  
* SSL/TLS:
   * Cryptographic protocols for secure communication (SSL is outdated; TLS is current)
  
 * Certificate:
   * A digital document that proves your site's identity
   
 * Certificate Authority (CA):
   * Trusted organization that issues certificates (e.g., Let's Encrypt, DigiCert)

* SSL/TLS Certificate:
  * Let's Encrypt: Free, automated certificates (90 day validity, auto renewal)
  * Commercial CAs: Paid certificates with extended validation options
  * Self-signed: For testing only (browsers show warnings)

* Basic Apache SSL Configuration
```
# Enable SSL module
# a2enmod ssl (on Debian/Ubuntu)

<VirtualHost *:443>
    ServerName www.example.com
    DocumentRoot /var/www/html
    
    # Enable SSL
    SSLEngine on
    
    # Certificate files
    SSLCertificateFile /path/to/certificate.crt
    SSLCertificateKeyFile /path/to/private.key
    SSLCertificateChainFile /path/to/chain.crt
    
    # Modern SSL configuration
    SSLProtocol all -SSLv3 -TLSv1 -TLSv1.1
    SSLCipherSuite HIGH:!aNULL:!MD5
    SSLHonorCipherOrder on
</VirtualHost>

# Redirect HTTP to HTTPS
<VirtualHost *:80>
    ServerName www.example.com
    Redirect permanent / https://www.example.com/
</VirtualHost>
```
  * Let's Encrypt with Certbot
```
# Install Certbot
sudo apt install certbot python3-certbot-apache

# Obtain and install certificate automatically
sudo certbot --apache -d example.com -d www.example.com

# Auto renewal (usually configured automatically)
sudo certbot renew --dry-run
```


**Complete Example**

**A. Install SSL Packages**
```bash
# Check existing packages
rpm -q httpd mod_ssl openssl

# Install if missing
sudo dnf install httpd mod_ssl openssl -y
```

**B. Firewall configuration**
```bash
sudo firewall-cmd --permanent --add-service=https
sudo firewall-cmd --reload
sudo firewall-cmd --list-all
```

**C. Generate Self-Signed Certificate**

 - Create certificate directory
```bash
sudo mkdir -p /etc/pki/tls/private
sudo mkdir -p /etc/pki/tls/certs
```
 - Generate self-signed certificate
```bash
sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
    -keyout /etc/pki/tls/private/localhost.key \
    -out /etc/pki/tls/certs/localhost.crt \
    -subj "/C=US/ST=State/L=City/O=Organization/CN=localhost"
```
<img width="786" height="298" alt="Screenshot 2026-01-28 at 9 28 17 AM" src="https://github.com/user-attachments/assets/8941c210-1b41-49f2-81db-13e307756587" />


**D. SSL Virtual Host Configuration (Observe)**

 - SSL configuration
   
     `sudo cat /etc/httpd/conf.d/ssl.conf`
   
```
SSLCertificateFile /etc/pki/tls/certs/localhost.crt
SSLCertificateKeyFile /etc/pki/tsl/private/localhost.key
```
<img width="652" height="176" alt="Screenshot 2025-11-07 at 10 57 12 AM" src="https://github.com/user-attachments/assets/269bbbd9-b7b0-4233-be1f-1fc995e87400" />

 - Virtual host configuration
```bash
sudo vim /etc/httpd/conf.d/ssl-website.conf
```
```apache
<VirtualHost *:443>
    ServerName www.devopsclass.com
    DocumentRoot /var/www/devopsclass
    
    # SSL Configuration
    SSLEngine on
    SSLCertificateFile /etc/pki/tls/certs/localhost.crt
    SSLCertificateKeyFile /etc/pki/tls/private/localhost.key
    
    # Security headers
    Header always set Strict-Transport-Security "max-age=63072000; includeSubDomains; preload"
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    
    <Directory "/var/www/devopsclass">
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>
    
    ErrorLog /var/log/httpd/ssl_error.log
    CustomLog /var/log/httpd/ssl_access.log combined
</VirtualHost>

# Redirect HTTP to HTTPS
<VirtualHost *:80>
    ServerName www.devopsclass.com
    Redirect permanent / https://www.devopsclass.com/
</VirtualHost>
```

**E. Directory & Permissions**

> If required, change the httpd.conf file: `sudo vim /etc/httpd/conf/httpd.conf`
> For this case: `DocumentRoot /var/www/devopsclass`
> `sudo systemctl restart httpd`

```bash
sudo mkdir -p /var/www/devopsclass
```

 `sudo vim /var/www/devopsclass/index.html`
 
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSL/TLS Connection Test</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            padding: 40px;
            max-width: 600px;
            width: 100%;
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 28px;
            text-align: center;
        }

        .subtitle {
            color: #666;
            text-align: center;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .status-badge {
            display: inline-block;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 25px;
            text-align: center;
            width: 100%;
        }

        .status-badge.secure {
            background-color: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
        }

        .status-badge.insecure {
            background-color: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
        }

        .status-badge::before {
            margin-right: 8px;
            font-size: 18px;
        }

        .status-badge.secure::before {
            content: '🔒';
        }

        .status-badge.insecure::before {
            content: '⚠️';
        }

        .info-section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .info-row:last-child {
            border-bottom: none;
        }

        .info-label {
            font-weight: 600;
            color: #495057;
        }

        .info-value {
            color: #6c757d;
            font-family: 'Courier New', monospace;
        }

        footer {
            margin-top: 25px;
            text-align: center;
            color: #999;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>SSL/TLS Connection Test</h1>
        <p class="subtitle">Verify your HTTPS configuration</p>
        
        <div id="status-badge" class="status-badge"></div>
        
        <div class="info-section">
            <div class="info-row">
                <span class="info-label">Protocol:</span>
                <span class="info-value" id="protocol"></span>
            </div>
            <div class="info-row">
                <span class="info-label">Host:</span>
                <span class="info-value" id="host"></span>
            </div>
            <div class="info-row">
                <span class="info-label">Port:</span>
                <span class="info-value" id="port"></span>
            </div>
            <div class="info-row">
                <span class="info-label">Secure Context:</span>
                <span class="info-value" id="secure-context"></span>
            </div>
        </div>

        <footer>
            Apache HTTPS Configuration Test Page
        </footer>
    </div>

    <script>
        // Check if connection is secure
        const isSecure = location.protocol === 'https:' && window.isSecureContext;
        
        // Update status badge
        const statusBadge = document.getElementById('status-badge');
        statusBadge.textContent = isSecure ? 'Secure Connection' : 'Insecure Connection';
        statusBadge.classList.add(isSecure ? 'secure' : 'insecure');
        
        // Populate connection information
        document.getElementById('protocol').textContent = location.protocol;
        document.getElementById('host').textContent = location.hostname;
        document.getElementById('port').textContent = location.port || (location.protocol === 'https:' ? '443' : '80');
        document.getElementById('secure-context').textContent = window.isSecureContext ? 'Yes' : 'No';
    </script>
</body>
</html>
```

 - Set permissions 
```bash
sudo chown -R apache:apache /var/www/devopsclass
sudo chmod -R 755 /var/www/devopsclass
```

 - Test and restart
```bash
sudo httpd -t
sudo systemctl restart httpd
```

**G. Test**

Test: `https://127.0.0.1/`  

  (Proceed past the browser warning for self-signed certificate)

<img width="1014" height="743" alt="Screenshot 2025-11-07 at 11 02 44 AM" src="https://github.com/user-attachments/assets/2b384eff-8cf3-479d-bc52-16c9498f625b" />


<img width="1450" height="788" alt="Screenshot 2026-01-28 at 11 31 26 AM" src="https://github.com/user-attachments/assets/b78c4c19-899e-4062-b73b-61c8a46fe339" />


---

**Remove/Stop Apache (if needed)**
 - If multiple services use the same port number on the same server, issues will occur. There are several ways to manage this, but for now, let’s simply disable, stop, or uninstall Apache.
 
```bash
systemctl disable httpd
systemctl stop httpd
dnf -y remove httpd
```

---


**References**

- `man httpd`, `man nginx`, `man firewall-cmd`, `man openssl`, `man docker`, `man kubectl`
- [Apache HTTP Server Docs](https://httpd.apache.org/docs/)
- [Nginx Docs](https://nginx.org/en/docs/)
- [Let’s Encrypt Certbot](https://certbot.eff.org/)
- [Terraform](https://www.terraform.io/docs/)
- [Ansible](https://docs.ansible.com/)
- [New Relic APM](https://docs.newrelic.com/docs/apm/)
- [Datadog APM](https://docs.datadoghq.com/apm/)
- [Elastic APM](https://www.elastic.co/guide/en/apm/get-started/current/overview.html)
- [Docker Docs](https://docs.docker.com/)
- [Kubernetes Ingress](https://kubernetes.io/docs/concepts/services-networking/ingress/)
- [GitHub Actions](https://docs.github.com/en/actions)
- [GitLab CI/CD](https://docs.gitlab.com/ee/ci/)
- [ModSecurity](https://modsecurity.org/)
- [AWS WAF](https://docs.aws.amazon.com/waf/latest/developerguide/)
- [Cloudflare WAF](https://developers.cloudflare.com/waf/)

---
