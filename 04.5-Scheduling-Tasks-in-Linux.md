# 7. Scheduling Tasks and Viewing Logs


## 7.1 Scheduling Tasks with Cron and At

**A. Cron for Recurring Jobs**

Cron runs commands on a schedule with minute-level precision. Each user can have their own crontab, and there are also system wide cron files.

- Edit your crontab: `crontab -e`
- List current crontab: `crontab -l`
- Remove current crontab: `crontab -r` (careful)
- Run as another user (root only): `sudo crontab -u username -e`
- Service names:
  - Debian/Ubuntu: `cron` (check: `systemctl status cron`)
  - RHEL/CentOS/Fedora: `crond` (check: `systemctl status crond`)
  

**Cron Expression Format**

Standard 5 field format:

`minute` `hour` `day of month` `month` `day of week`

 ` *       *          *         *        *            <Commands/Scripts>`

```
| Field         | Range        | Notes                         |
|---------------|--------------|-------------------------------|
| Minute        | 0‚Äì59         |                               |
| Hour          | 0‚Äì23         |                               |
| Day of Month  | 1‚Äì31         |                               |
| Month         | 1‚Äì12         |                               |
| Day of Week   | 0‚Äì6 (Sun‚ÄìSat)| 0=Sunday                      |
```

**Operators:**
- Ranges: `1-5`
    - Means ‚Äúfrom 1 through 5‚Äù in that field.
      - Example (weekdays 9:00): `0 9 * * 1-5 mycmd`
    
- Lists: `1,2,5`
    - Means ‚Äú1 OR 2 OR 5‚Äù in that field.
      - Example (1st and 15th at midnight): `0 0 1,15 * * mycmd`
  
- Steps: `*/5` (every 5 units), `1-10/2`
    - */n: every n units starting at the minimum for that field.
        - Every 5 minutes: `*/5 * * * * mycmd`
          
    - x-y/n: every n units within x‚Äìy, starting at x.
        - 1-10/2 ‚Üí 1,3,5,7,9
        - Example (every 2 hours from 8 to 18): `0 8-18/2 * * * mycmd`

- Aliases (shortcuts for whole schedules):
    - @reboot ‚Üí run once when the machine/cron starts
    - @hourly ‚Üí `0 * * * *`
    - @daily (aka @midnight) ‚Üí `0 0 * * *`
    - @weekly ‚Üí `0 0 * * 0`
    - @monthly ‚Üí `0 0 1 * *`
    - @yearly (aka @annually) ‚Üí `0 0 1 1 *`
    - Example: `@reboot mycmd`

> Important matching rule: a job runs when EITHER day of month OR day of week matches (not necessarily both).


**Examples:**

```
Notes:
 - Use absolute paths for commands and logs (cron's PATH is minimal).
 - Prefer $HOME over ~ in cron.
 - '>>' appends output; '2>&1' sends errors to the same log.
 - Times are in the system's local timezone.
```

- Every 5 minutes
```
*/5 * * * * /usr/local/bin/ping-health
```
Check it with:
`sudo grep CRON /var/log/cron`

- Every 15 minutes
```
*/15 * * * * /path/to/command
```

- Daily at 03:00 (3 AM)
```
0 3 * * * /path/to/script.sh
```

- Daily at 03:00 with logging (append stdout+stderr)
```
0 3 * * * /usr/local/bin/backup.sh >> /var/log/backup.log 2>&1
```

- Weekdays (Mon‚ÄìFri) at 09:15
```
15 9 * * 1-5 /usr/local/bin/report.sh
```

- Weekdays (Mon‚ÄìFri) at 17:00 (5 PM)
```
0 17 * * 1-5 /path/to/command
```

- Show logged in users once daily at 09:00
```
0 9 * * * /usr/bin/who >> $HOME/loginlist
```

- Show logged in users every minute
```
* * * * * /usr/bin/who >> $HOME/loginlist
```

<img width="758" height="334" alt="Screenshot 2025-10-27 at 7 47 02‚ÄØAM" src="https://github.com/user-attachments/assets/e7c81b38-8026-4e5b-b617-b517b05c1eb1" />


```
# Show logged-in users every 15 minutes
*/15 * * * * /usr/bin/who >> $HOME/presentlist
```

```
# First of every month at 02:30
30 2 1 * * /usr/local/bin/monthly.sh
```

```
# Run once at boot (when cron/host starts)
@reboot /usr/local/bin/startup-check
```

```
# Every 2 minutes: users and date (grouped; one entry per run)
*/2 * * * * (/usr/bin/who; /usr/bin/date) >> $HOME/listwithdate
```

```
# Every 2 minutes: memory and disk info with a timestamp header
*/2 * * * * (echo "= $(/usr/bin/date) ="; /usr/bin/free -h; /usr/bin/df -h) >> $HOME/info
```
<img width="800" height="489" alt="Screenshot 2025-10-27 at 7 53 33‚ÄØAM" src="https://github.com/user-attachments/assets/862de863-27c1-4117-9c48-b080d5f3eb55" />

```
# Daily at midnight via alias (equivalent to 0 0 * * *)
@daily /path/to/script.sh
```

**Verification:**
```bash
crontab -l                           # List current user's jobs
```
```bash
sudo crontab -l -u username          # List jobs for another user
```


****Where Cron Reads Jobs From? System-wide CronJobs:**
- Per-user crontabs: `/var/spool/cron/crontabs/<user>` (edit via `crontab -e`)
- System crontab: `/etc/crontab` (has an extra ‚Äúuser‚Äù field)
- Drop-in directory: `/etc/cron.d/*` (also has ‚Äúuser‚Äù field)
- Periodic directories (run by `run-parts`):
  - `/etc/cron.hourly/`
  - `/etc/cron.daily/`
  - `/etc/cron.weekly/`
  - `/etc/cron.monthly/`

Note: `run-parts` imposes strict filename rules (no dots by default on many distros). Use hyphens/underscores instead.

<img width="799" height="513" alt="Screenshot 2025-10-27 at 7 26 49‚ÄØAM" src="https://github.com/user-attachments/assets/0e523bf6-f5b6-4b51-bec8-3992aca11c99" />

**Format differences**
- User crontab (5 fields): `m h dom mon dow command`
- `/etc/crontab` and `/etc/cron.d/*` (6 fields): `m h dom mon dow user command`

<img width="768" height="234" alt="Screenshot 2025-10-27 at 7 55 07‚ÄØAM" src="https://github.com/user-attachments/assets/625c18e2-9298-49ce-af04-9c5fc2f4d9d1" />


Example in `/etc/cron.d/`:
```
# m  h  dom mon dow  user  command
15  1  *   *   *     root  /usr/local/bin/rotate-keys
```

**Environment in Cron**

Cron runs with a minimal environment. Set what you need explicitly.

Common headers (at top of crontab):
```
SHELL=/bin/bash
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
MAILTO=ops@example.com                                                      # or empty to suppress mail: MAILTO=""
TZ=UTC                                                                      # TZ settings vary by implementation; see below
```

- PATH: Always set full PATH or use absolute paths for commands.
- MAILTO: Cron emails stdout/stderr to this address if a local MTA is configured.
- SHELL: Use bash if your scripts rely on bash-isms.


**Timezones and DST((Daylight Saving Time)**
- Cron typically uses the system timezone.
- Vixie/modern cron often support per-line `CRON_TZ=Zone/Name` and global `TZ=...` (but not universal across all implementations).

- DST:
  - When clocks change (spring forward / fall back):
      - During spring forward (DST start): The skipped hour means cron jobs scheduled inside that missing hour simply won‚Äôt run.
      - During fall back (DST end): The repeated hour causes cron jobs to run twice ‚Äî once in each occurrence of that hour.
  - This can be problematic for things like database updates, financial transactions, or emails.
  - Jobs may skip or run twice during transitions. For critical jobs, make them idempotent or use systemd timers with `OnCalendar=` and `Persistent=`.

**Examples:**
```
[Timer]
OnCalendar=*-*-* 06:00:00
Persistent=true
```
```
# Whole file in UTC (if implementation supports)
TZ=UTC
0 6 * * * /usr/local/bin/daily-report
```
```
# Per-job timezone (Vixie cron / Debian/Ubuntu often support)
CRON_TZ=US/Eastern
0 6 * * * /usr/local/bin/east-coast-task
```

**Output, Logging, and Debugging**

- Redirect output to logs:
  - `>> /var/log/task.log 2>&1` (append)
  - `> /var/log/task.log 2>&1` (overwrite)
  
- Syslog locations:
  - Debian/Ubuntu: `/var/log/syslog` (grep cron)
  - RHEL/CentOS: `/var/log/cron`
  - Journal: `journalctl -u cron` or `journalctl -u crond`
  
- Test command interactively first, then paste into crontab.
- Use absolute paths for binaries and files.
- Remember percent signs `%` are special in Vixie cron: they are converted to newlines in the command. Escape as `\%` or quote the command.


**Avoid Overlaps and Long Runs**

Essentials:
 - Use absolute paths for binaries.
 - Pick a writable lock directory: /run/lock (root) or $HOME/.cache/locks (non-root).
 - Prevent overlaps: skip if busy (-n) or wait up to N seconds (-w N).
 - Cap runtime with timeout to avoid stuck jobs.
 - Stagger starts (jitter) for multi-host setups.
 - Throttle resource usage with nice (CPU) and ionice (IO).
 - Consider systemd timers for built-in jitter (RandomizedDelaySec) and missed-run handling (Persistent).


**Examples:**
```
# Skip if already running
*/5 * * * * /usr/bin/flock -n /run/lock/myjob.lock /usr/local/bin/myjob >> /var/log/myjob.log 2>&1

# Wait up to 2 min for lock
*/5 * * * * /usr/bin/flock -w 120 /run/lock/myjob.lock /usr/local/bin/myjob >> /var/log/myjob.log 2>&1

# Lock + max runtime
*/5 * * * * /usr/bin/flock -n /run/lock/myjob.lock -c "/usr/bin/timeout 20m /usr/local/bin/myjob >> /var/log/myjob.log 2>&1"

# Jitter (stagger start by up to 30s)
*/5 * * * * sleep $(/usr/bin/shuf -i 0-30 -n 1); /usr/local/bin/worker >> /var/log/worker.log 2>&1

# Throttle CPU & IO
0 * * * * /usr/bin/nice -n 10 /usr/bin/ionice -c2 -n7 /usr/local/bin/big-job >> /var/log/big-job.log 2>&1

# Optional: send to syslog instead of a file
# ... 2>&1 | /usr/bin/logger -t myjob
```

---

**B. Managing Crontab and One-Time Jobs**

| Action                | Command                       | Notes                              |
|-----------------------|-------------------------------|------------------------------------|
| Edit jobs             | `crontab -e`                  | Current user                       |
| List jobs             | `crontab -l`                  |                                    |
| Remove all jobs       | `crontab -r`                  | CAREFUL: removes all jobs          |
| Edit root's jobs      | `sudo crontab -e`             | For system or root jobs            |
| Set environment vars  | At top of crontab             | e.g., `PATH=/usr/local/sbin:/usr/sbin:/sbin:/usr/bin:/bin` |
| Restart cron service  | `sudo systemctl restart crond`| After major changes or troubleshooting |
| Logging/Output        | `> /path/to/log 2>&1`         | Or discard: `> /dev/null 2>&1`     |


**One-Time Jobs with `at`:**

  - `at` schedules a one-time command to run in the future.
  - Jobs run in the background by atd. Ensure the atd service is running.
  - Commands are executed by /bin/sh, not necessarily your login shell.

  at Time Formats:
    - Absolute Time: 14:30 or 2:30 PM ‚Üí Today at that time
    - Relative Time: now + 10 minutes/hours/days ‚Üí From current time
    - Specific Date: 09:00 2025-11-30 or 9:00 AM Dec 1 ‚Üí Exact date & time
    - Special Keywords: midnight, noon, teatime ‚Üí Today at standard times
    - Days / Weeks: next Mon, Jul 4 ‚Üí Specific weekday or date
    - Combined: 2 PM + 2 days ‚Üí Relative time from a specified hour

  Scheduling a job:

    Interactive:
      `at now + 1 minutes`
          at> echo "Hello from at!, See you in 1 minutes">>~/atjob
          at> Ctrl-D (send EOF to save)
          
  <img width="749" height="260" alt="Screenshot 2025-10-27 at 9 37 07‚ÄØAM" src="https://github.com/user-attachments/assets/40f02e55-cef5-498d-ba2a-e1bda3271e4c" />

    Non-interactive:
      `echo 'echo "Hello" >> /tmp/atlog' | at now + 1 hour`
      
  <img width="800" height="83" alt="Screenshot 2025-10-27 at 9 40 57‚ÄØAM" src="https://github.com/user-attachments/assets/c4b91b5a-b8ca-43a6-8a8b-e849fe6e9440" />

      
      `at -f /path/to/script.sh 09:00 tomorrow`
      
      `echo 'echo "run at exact time" >> /tmp/atlog' | at -t 202510271530`
      
  <img width="799" height="91" alt="Screenshot 2025-10-27 at 9 43 04‚ÄØAM" src="https://github.com/user-attachments/assets/b1c3b012-38d6-42b6-a2f3-1f5f72367a3c" />


  Managing job
      List: `atq` (or `at -l`)
      Remove: `atrm <job_id>` (or `at -d <job_id>`)
      Show job contents: `at -c <job_id>`
      
<img width="802" height="519" alt="Screenshot 2025-10-27 at 9 44 57‚ÄØAM" src="https://github.com/user-attachments/assets/83a757c4-2ed3-41d5-b275-ca76aeb840cc" />


---

## 7.2 Viewing and Managing Logs

Linux logs are crucial for system monitoring, debugging, and security auditing. They are text-based records of events generated by the kernel, services, and applications.

**A. Understanding Log Locations**

- **Primary Directory:** The default directory for most log files. `/var/log/`

<img width="797" height="289" alt="Screenshot 2025-10-27 at 11 57 25‚ÄØAM" src="https://github.com/user-attachments/assets/baba1c78-28b0-4c3c-af70-2d29843c7c27" />

  
- **Common Log Files:**
  - System Logs: `syslog`, `messages`
  - Authentication: `auth.log` (Debian/Ubuntu) or `secure` (RHEL/CentOS)
  - Kernel: `kern.log`
  - Boot Process: `boot.log`
  - Package Manager: `dpkg.log` (Debian/Ubuntu), `yum.log` (RHEL/CentOS)
  - Application logs: `/var/log/nginx/`, `/var/log/apache2/`, etc.

---

**Log Format:**
```
<timestamp> <hostname> <service>[pid]: <message>
```
Example:

<img width="875" height="43" alt="Screenshot 2025-10-27 at 11 59 14‚ÄØAM" src="https://github.com/user-attachments/assets/27859dd6-33ab-4a48-89e4-6bc659f98dda" />

**Systemd Journals:**  
- Stored in `/var/log/journal` if persistent enabled

---

### B. **Viewing Logs**


| Tool      | Example Command                               | Use Case                 |
|-----------|-----------------------------------------------|--------------------------|
| `ls`      | `ls /var/log`                                 | List log files           |
| `cat`     | `sudo cat /var/log/messages`                  | View entire file         |
| `tail`    | `sudo tail -n 20 /var/log/secure`             | Last 20 lines            |
| `tail -f` | `sudo tail -f /var/log/messages`              | Real-time monitoring     |
| `less`    | `less /var/log/dnf.log`                       | Interactive scroll/search|
| `grep`    | `grep "failed" /var/log/secure`               | Filter lines             |
| `zgrep`   | `zgrep "failed" /var/log/auth.log.1.gz`       | Search compressed log    |


**Tools for Viewing Logs**

 **journalctl**: The primary tool for querying logs from **systemd's journal** (modern Linux distributions).
 
 <img width="1013" height="514" alt="Screenshot 2025-10-27 at 12 01 02‚ÄØPM" src="https://github.com/user-attachments/assets/7bf85e5d-f243-41f7-8a9e-d7da427f8fdd" />

     - `journalctl`:                               View all logs.
     - `journalctl -f`:                            Follow (tail) new log entries in real-time.
     
  <img width="1003" height="438" alt="Screenshot 2025-10-27 at 12 03 41‚ÄØPM" src="https://github.com/user-attachments/assets/b4155e66-c8b8-471f-93c1-e60904aa76c0" />
  
<img width="1020" height="52" alt="Screenshot 2025-10-27 at 12 05 41‚ÄØPM" src="https://github.com/user-attachments/assets/10cfe8e5-5a72-41a0-8fb5-d15d7802a7a5" />

<img width="973" height="60" alt="Screenshot 2025-10-27 at 12 06 19‚ÄØPM" src="https://github.com/user-attachments/assets/2c5ec21c-dafb-4ae3-887f-9540733b130c" />


     - `journalctl -u <service-name>`:             View logs for a specific service.

  <img width="796" height="213" alt="Screenshot 2025-10-27 at 12 12 42‚ÄØPM" src="https://github.com/user-attachments/assets/bfb2fd82-bb59-4be0-a400-d36adab904cd" />

     
     - `journalctl --since "yyyy-mm-dd HH:MM:SS"`: View logs since a specific time.
    
<img width="802" height="478" alt="Screenshot 2025-10-27 at 12 14 05‚ÄØPM" src="https://github.com/user-attachments/assets/46805269-5e1c-4247-85b8-c995606e120f" />

     
     - `journalctl -p err..alert`:                 Filter by priority (e.g., `err`, `warning`, `info`).

<img width="856" height="495" alt="Screenshot 2025-10-27 at 12 15 18‚ÄØPM" src="https://github.com/user-attachments/assets/f5ab4ab1-7f9c-4616-9186-882683027f9f" />



**Classic Text Log Utilities** (for files in `/var/log/`):

      - `tail`:                             View the end of a file.
          - `tail -f /var/log/messages`:     Follow a log file in real-time.

<img width="1059" height="469" alt="Screenshot 2025-10-27 at 12 08 56‚ÄØPM" src="https://github.com/user-attachments/assets/ee756e72-0569-41f6-b114-7e7128a7088a" />

          
      - `less` / `cat`:                     Page through or display entire log files.
      - `grep`:                             Search for specific patterns or keywords.
          - `grep "error" /var/log/messages`
          
   <img width="959" height="260" alt="Screenshot 2025-10-27 at 12 10 33‚ÄØPM" src="https://github.com/user-attachments/assets/806eaa52-2176-4b44-a4d4-4aa105657099" />


**More Examples:**

```bash
journalctl -u nginx.service                              # Logs for httpd service
journalctl -b                                            # Logs since last boot
journalctl -p err -b                                     # Errors since boot
journalctl -f                                            # Follow new logs
journalctl --since "2024-10-01" --until "2025-04-02"
```

Export logs:
```bash
journalctl -u sshd > sshd_logs.txt
```

---

### C. **Rotating Logs with logrotate**

`logrotate` is an automated log management utility that:
  - Prevents disk exhaustion by archiving and removing old logs
  - Compresses log files to save space
  - Maintains a fixed number of historical log files
  - Can execute scripts before/after rotation (e.g., reloading services)
  

**Main Configuration file:**
  - Contains global settings and defaults
  - Includes service-specific configs from /etc/logrotate.d/
```bash
cat /etc/logrotate.conf
```

**Service-Specific Configurations:**
  - Individual files for each service (nginx, apache, mysql, etc.)
  - Override global settings as needed
```bash
cd /etc/logrotate.d/
```

<img width="770" height="126" alt="Screenshot 2025-10-27 at 12 24 37‚ÄØPM" src="https://github.com/user-attachments/assets/3f29a71d-3cf5-4bcf-b767-20745ab9191d" />


**Example: Nginx log rotation configuration:**
```
/var/log/nginx/*.log {
    daily                          # Rotate logs daily
    missingok                      # Don't error if log is missing
    rotate 7                       # Keep 7 rotated logs (1 week)
    compress                       # Compress rotated logs with gzip
    delaycompress                  # Delay compression until next rotation
    notifempty                     # Don't rotate empty files
    create 0640 www-data adm       # Recreate log with specified permissions/ownership
    sharedscripts                  # Run scripts only once for all matched logs
    postrotate                     # Script to run after rotation
        systemctl reload nginx     # Gracefully reload nginx to use new log files
    endscript
}
```

**Manual Operations & Testing**

Force Immediate Rotation:
```bash
logrotate -vf /etc/logrotate.d/nginx     # Force rotation
```
  -v: Verbose output
  -f: Force rotation regardless of schedule
  
<img width="796" height="669" alt="Screenshot 2025-10-27 at 12 31 41‚ÄØPM" src="https://github.com/user-attachments/assets/59ad1aee-9052-4ba8-9c8a-c95ff943cb2a" />

Dry Run (Test Configuration):
```bash
logrotate -d /etc/logrotate.d/nginx      # Dry-run/debug
```
  -d: Debug mode - shows what would happen without making changes

**Track Last Rotation:**
```bash
sudo cat /var/lib/logrotate/logrotate.status
```

---

## 7.3 Cloud/Scheduled Jobs & Log Management Context

**AWS Example (Scheduled Tasks)**
- Use **CloudWatch Events** or **EventBridge** for scheduled Lambda/EC2 actions.
- Use **CloudWatch Logs** for log aggregation and retention policies.

**Azure Example**
- Use **Azure Automation Runbooks** or **Logic Apps** for scheduled tasks.
- Use **Azure Monitor Logs** for log collection and analysis.

**GCP Example**
- Use **Cloud Scheduler** for cron-like scheduled jobs.
- Use **Cloud Logging** for system and application log management.


---


## 7.4 Advanced/Enterprise Enhancements

**A. systemd Timers**

Systemd timers provide a modern, robust scheduling solution that integrates seamlessly with Linux systems, offering improved logging and functionality compared to traditional cron jobs.

**Setup Process:**
  - Create timer unit: `/etc/systemd/system/myjob.timer`
  ```
[Unit]
Description=Run myjob every day

[Timer]
OnCalendar=daily
Persistent=true
# Alternative: OnCalendar=*-*-* 02:00:00 (daily at 2 AM)

[Install]
WantedBy=timers.target
  ```
  
  - Create service unit: `/etc/systemd/system/myjob.service`
```
[Unit]
Description=Run myjob script

[Service]
Type=simple
ExecStart=/path/to/script.sh
User=myuser  # Optional: run as specific user
```
  
  - Enable & start timer:
```bash
systemctl daemon-reload
systemctl enable --now myjob.timer
systemctl list-timers myjob.timer  # Check status
journalctl -u myjob.service        # View logs
```

---

**B. Centralized Log Aggregation**

- ELK Stack (Elasticsearch, Logstash, Kibana):
  - Filebeat: Lightweight log shipper ‚Üí Logstash: Log processing ‚Üí Elasticsearch: Storage & search ‚Üí Kibana: Visualization
  - Setup
```bash
# Filebeat configuration (/etc/filebeat/filebeat.yml)
filebeat.inputs:
- type: log
  paths: [/var/log/*.log]
output.logstash:
  hosts: ["logstash-server:5044"]
```

- Cloud Solutions:
    - Datadog: Agent-based collection with rich dashboards
    - AWS CloudWatch: Native AWS service with Logs Insights
    - Splunk: Enterprise-grade log analysis

---

**C. Alerting Integrations**

Automate notifications and incident response:

Notification Channels:
  - Email/SMS: Traditional alert delivery
  - Webhooks: HTTP callbacks to custom systems
  - PagerDuty: On-call rotation management
  - Slack/Teams: Team collaboration platforms

**Example (ELK Watcher):**
```json
{
  "trigger": { "schedule": { "interval": "1m" } },
  "input": {
    "search": {
      "request": {
        "indices": ["logstash-*"],
        "body": {
          "query": { "match": { "level": "ERROR" } }
        }
      }
    }
  },
  "actions": {
    "email_admin": {
      "email": {
        "to": "admin@example.com",
        "subject": "üö® Error Log Detected",
        "body": "Found {{ctx.payload.hits.total}} errors in logs"
      }
    }
  }
}
```

---


**D. Advanced Audit and Compliance Reporting**

- Use tools like **auditd** for OS-level tracking.
- Export and rotate audit logs.

**auditd System Example:**
```bash
# Monitor file access
auditctl -w /etc/passwd -p wa -k passwd_changes

# Monitor system calls
auditctl -a always,exit -S open -S openat -k file_access

# Search audit logs
ausearch -k passwd_changes
aureport -f  # File access report
```

SIEM Integration (Security Information and Event Management)
  - Export audit logs to Splunk, ArcSight, or QRadar
  - Generate compliance reports (PCI-DSS, HIPAA, SOX)

---

**E. Container-Native Scheduling and Logging**

- **Kubernetes CronJob:**

```yaml
apiVersion: batch/v1
kind: CronJob
metadata:
  name: backup-job
spec:
  schedule: "0 2 * * *"        # 2 AM daily
  concurrencyPolicy: Forbid    # Prevent overlapping runs
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: backup
            image: backup-tool:latest
            args: ["/opt/backup.sh"]
          restartPolicy: OnFailure
  ```
  
- **Sidecar Logging:**
  - Deploy log collector containers (e.g., Fluentd) alongside app containers for centralized logging.
    
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: app-with-logging
spec:
  containers:
  - name: app
    image: my-app:latest
  - name: log-collector          # Sidecar container
    image: fluentd:latest
    volumeMounts:
    - name: logs
      mountPath: /var/log/app
```

---

**F. Automated Recovery/Remediation Jobs**

- Use automated scripts or orchestration tools to respond to detected failures (e.g., restart service, scale resources).
- Integrate with alerting systems to trigger remediation flows.

**Example: Self-Healing Systems**
  - AWS Lambda + CloudWatch: Auto-remediate EC2 issues
  - Ansible Tower: Run playbooks on alert detection
  - Custom Scripts: Restart services, scale resources

**Example: Service Restart Automation**
```bash
#!/bin/bash
# remediation-script.sh
if ! systemctl is-active --quiet nginx; then
    systemctl restart nginx
    echo "nginx restarted at $(date)" >> /var/log/remediation.log
    # Send alert
    curl -X POST -H 'Content-type: application/json' \
         --data '{"text":"nginx was restarted automatically"}' \
         $SLACK_WEBHOOK
fi
```

**Schedule with systemd timer:**
```ini
# /etc/systemd/system/health-check.timer
[Timer]
OnBootSec=5min
OnUnitActiveSec=2min
```

---
